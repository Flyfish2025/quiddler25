<Backend code from canvas – omitted for brevity>